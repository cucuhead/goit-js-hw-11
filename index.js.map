{"version":3,"file":"index.js","sources":["../src/search.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.getElementById('search-form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadingText = document.querySelector('.loading-text');\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '51560990-264b69e56c9798190df8f6558';\n\nconst lightbox = new SimpleLightbox('.gallery a');\n\n// Sayfa yüklendiğinde URL'deki query'yi form alanına yaz\nwindow.addEventListener('DOMContentLoaded', () => {\n  const params = new URLSearchParams(window.location.search);\n  const query = params.get('query');\n  if (query) {\n    form.searchQuery.value = query;\n    performSearch(query); // sayfa yüklenince otomatik arama yapar\n  }\n});\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n  const query = form.searchQuery.value.trim();\n  if (!query) return;\n  updateQueryParam(query); // URL'yi güncelle\n  performSearch(query);\n});\n\nfunction updateQueryParam(query) {\n  const newUrl = `${window.location.pathname}?query=${encodeURIComponent(query)}`;\n  window.history.pushState({ path: newUrl }, '', newUrl);\n}\n\nasync function performSearch(query) {\n  gallery.innerHTML = '';\n  gallery.style.display = 'none';\n  loader.hidden = false;\n  loadingText.hidden = false;\n\n  try {\n    const data = await fetchImages(query);\n\n    if (data.hits.length === 0) {\n      iziToast.warning({\n        class: 'my-warning-toast',\n        message: 'Sorry, no images match your search. Please try again!',\n        position: 'topRight',\n      });\n      hideLoading();\n      return;\n    }\n\n    renderGallery(data.hits);\n  } catch (error) {\n    iziToast.error({\n      message: 'Something went wrong. Please try again later.',\n      position: 'topRight',\n    });\n    hideLoading();\n  }\n}\n\nfunction hideLoading() {\n  loader.hidden = true;\n  loadingText.hidden = true;\n  gallery.style.display = 'grid';\n}\n\nfunction fetchImages(query) {\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n  });\n\n  return fetch(`${BASE_URL}?${params}`).then(response => {\n    if (!response.ok) {\n      throw new Error('Fetch failed');\n    }\n    return response.json();\n  });\n}\n\nfunction renderGallery(images) {\n  const markup = images\n    .map(image => `\n      <li class=\"gallery-item\">\n        <div class=\"photo-card\">\n          <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n          </a>\n          <div class=\"info\">\n            <div class=\"info-column\">\n              <span class=\"info-label\">Likes</span>\n              <span class=\"info-value\">${image.likes}</span>\n            </div>\n            <div class=\"info-column\">\n              <span class=\"info-label\">Views</span>\n              <span class=\"info-value\">${image.views}</span>\n            </div>\n            <div class=\"info-column\">\n              <span class=\"info-label\">Comments</span>\n              <span class=\"info-value\">${image.comments}</span>\n            </div>\n            <div class=\"info-column\">\n              <span class=\"info-label\">Downloads</span>\n              <span class=\"info-value\">${image.downloads}</span>\n            </div>\n          </div>\n        </div>\n      </li>\n    `)\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n  const imagesOnPage = gallery.querySelectorAll('img.gallery-image');\n  let loadedCount = 0;\n\n  if (imagesOnPage.length === 0) {\n    hideLoading();\n    lightbox.refresh();\n    return;\n  }\n\n  imagesOnPage.forEach(img => {\n    if (img.complete) {\n      incrementCounter();\n    } else {\n      img.addEventListener('load', incrementCounter);\n      img.addEventListener('error', incrementCounter);\n    }\n  });\n\n  function incrementCounter() {\n    loadedCount++;\n    if (loadedCount === imagesOnPage.length) {\n      hideLoading();\n      lightbox.refresh();\n    }\n  }\n}\n"],"names":["form","gallery","loader","loadingText","BASE_URL","API_KEY","lightbox","SimpleLightbox","query","performSearch","event","updateQueryParam","newUrl","data","fetchImages","iziToast","hideLoading","renderGallery","params","response","images","markup","image","imagesOnPage","loadedCount","img","incrementCounter"],"mappings":"6vBAMA,MAAMA,EAAO,SAAS,eAAe,aAAa,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,eAAe,EAEpDC,EAAW,2BACXC,EAAU,qCAEVC,EAAW,IAAIC,EAAe,YAAY,EAGhD,OAAO,iBAAiB,mBAAoB,IAAM,CAEhD,MAAMC,EADS,IAAI,gBAAgB,OAAO,SAAS,MAAM,EACpC,IAAI,OAAO,EAC5BA,IACFR,EAAK,YAAY,MAAQQ,EACzBC,EAAcD,CAAK,EAEvB,CAAC,EAEDR,EAAK,iBAAiB,SAAU,MAAMU,GAAS,CAC7CA,EAAM,eAAc,EACpB,MAAMF,EAAQR,EAAK,YAAY,MAAM,KAAI,EACpCQ,IACLG,EAAiBH,CAAK,EACtBC,EAAcD,CAAK,EACrB,CAAC,EAED,SAASG,EAAiBH,EAAO,CAC/B,MAAMI,EAAS,GAAG,OAAO,SAAS,QAAQ,UAAU,mBAAmBJ,CAAK,CAAC,GAC7E,OAAO,QAAQ,UAAU,CAAE,KAAMI,GAAU,GAAIA,CAAM,CACvD,CAEA,eAAeH,EAAcD,EAAO,CAClCP,EAAQ,UAAY,GACpBA,EAAQ,MAAM,QAAU,OACxBC,EAAO,OAAS,GAChBC,EAAY,OAAS,GAErB,GAAI,CACF,MAAMU,EAAO,MAAMC,EAAYN,CAAK,EAEpC,GAAIK,EAAK,KAAK,SAAW,EAAG,CAC1BE,EAAS,QAAQ,CACf,MAAO,mBACP,QAAS,wDACT,SAAU,UAClB,CAAO,EACDC,IACA,MACD,CAEDC,EAAcJ,EAAK,IAAI,CACxB,MAAe,CACdE,EAAS,MAAM,CACb,QAAS,gDACT,SAAU,UAChB,CAAK,EACDC,GACD,CACH,CAEA,SAASA,GAAc,CACrBd,EAAO,OAAS,GAChBC,EAAY,OAAS,GACrBF,EAAQ,MAAM,QAAU,MAC1B,CAEA,SAASa,EAAYN,EAAO,CAC1B,MAAMU,EAAS,IAAI,gBAAgB,CACjC,IAAKb,EACL,EAAGG,EACH,WAAY,QACZ,YAAa,aACb,WAAY,MAChB,CAAG,EAED,OAAO,MAAM,GAAGJ,CAAQ,IAAIc,CAAM,EAAE,EAAE,KAAKC,GAAY,CACrD,GAAI,CAACA,EAAS,GACZ,MAAM,IAAI,MAAM,cAAc,EAEhC,OAAOA,EAAS,MACpB,CAAG,CACH,CAEA,SAASF,EAAcG,EAAQ,CAC7B,MAAMC,EAASD,EACZ,IAAIE,GAAS;AAAA;AAAA;AAAA,0CAGwBA,EAAM,aAAa;AAAA,8CACfA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA,yCAK3CA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,yCAIXA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,yCAIXA,EAAM,QAAQ;AAAA;AAAA;AAAA;AAAA,yCAIdA,EAAM,SAAS;AAAA;AAAA;AAAA;AAAA;AAAA,KAKnD,EACA,KAAK,EAAE,EAEVrB,EAAQ,mBAAmB,YAAaoB,CAAM,EAE9C,MAAME,EAAetB,EAAQ,iBAAiB,mBAAmB,EACjE,IAAIuB,EAAc,EAElB,GAAID,EAAa,SAAW,EAAG,CAC7BP,IACAV,EAAS,QAAO,EAChB,MACD,CAEDiB,EAAa,QAAQE,GAAO,CACtBA,EAAI,SACNC,KAEAD,EAAI,iBAAiB,OAAQC,CAAgB,EAC7CD,EAAI,iBAAiB,QAASC,CAAgB,EAEpD,CAAG,EAED,SAASA,GAAmB,CAC1BF,IACIA,IAAgBD,EAAa,SAC/BP,IACAV,EAAS,QAAO,EAEnB,CACH"}